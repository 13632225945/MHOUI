var MHO={};$(function(t){var e=function(){this.status.$proxy.css({left:this.status.currentX-this.status.startX+this.status.startX-this.status.startOffsetLeft,top:this.status.currentY-this.status.startY+this.status.startY-this.status.startOffsetTop})},o={$el:$("<div></div>"),$proxy:null,revert:!1,onBeforeDrag:function(t){},onStartDrag:function(t){},onDrag:function(t){},onStopDrag:function(t){}},i=function(t){this.setting=$.extend({},o,t),this.status={startPosition:null,startTop:null,startLeft:null,startX:null,startY:null,startOffsetLeft:null,startOffsetTop:null,isDragging:!1,currentX:null,currentY:null,$proxy:null};var e=this.setting.$el.addClass("mho-draggable");$.extend(this,{$el:e}),this.init()};$.extend(i.prototype,{init:function(){var t=this;this.setting.$el.bind("mousedown.draggable",function(o){if(0==t.setting.onBeforeDrag.call(this,o))return!1;$.extend(t.status,{startPosition:$(o.currentTarget).css("position"),startTop:$(o.currentTarget).position().top,startLeft:$(o.currentTarget).position().left,startX:o.pageX,startY:o.pageY,startOffsetLeft:o.pageX-$(o.currentTarget).offset().left,startOffsetTop:o.pageY-$(o.currentTarget).offset().top,isDragging:!0,$proxy:"function"==typeof t.setting.$proxy?t.setting.$proxy():t.setting.$proxy||t.$el}),$(o.currentTarget).css("cursor","move"),$(document).bind("mousedown.draggable",function(e){(function(t){this.status.$proxy.css({position:"absolute",left:this.status.startX-this.status.startOffsetLeft,top:this.status.startY-this.status.startOffsetTop}),this.setting.onStartDrag.call(this,t)}).call(t,e)}),$(document).bind("mousemove.draggable",function(o){(function(t){if(0==this.status.isDragging)return!1;$.extend(this.status,{currentX:t.pageX,currentY:t.pageY}),0!=this.setting.onDrag.call(this,t)&&e.call(this)}).call(t,o)}),$(document).bind("mouseup.draggable",function(o){(function(t){e.call(this),this.status.$proxy!=this.$el&&(this.$el.css({position:this.status.$proxy.css("position"),left:this.status.$proxy.css("left"),top:this.status.$proxy.css("top")}),this.status.$proxy.remove()),1==this.setting.revert&&this.$el.css({position:this.status.startPosition,left:this.status.startLeft,top:this.status.startTop}),$.extend(this.status,{isDragging:!1}),this.setting.onStopDrag.call(this,t),$(document).unbind(".draggable"),$("body").css("cursor","")}).call(t,o)})})},getMoveOffset:function(){return{x:this.status.currentX-this.status.startX,Y:this.status.currentY-this.status.startY}}}),t.draggable=i}(MHO)),$(function(t){var e=function(t){var e=function(t,e){var o=e?e.offset():$(t.currentTarget).offset(),i=e?e.outerWidth():$(t.currentTarget).outerWidth(),a=e?e.outerHeight():$(t.currentTarget).outerHeight(),s=t.pageX,n=t.pageY;return{top:n-o.top,bottom:o.top+a-n,left:s-o.left,right:o.left+i-s}}(t),o="";return e.right<=this.setting.edge&&e.bottom>this.setting.edge&&"v"!=this.setting.direction?o="e":e.right>this.setting.edge&&e.bottom<=this.setting.edge&&"h"!=this.setting.direction?o="s":e.right<=this.setting.edge&&e.bottom<=this.setting.edge&&"h"!=this.setting.direction&&"v"!=this.setting.direction&&(o="se"),o},o=function(){var t=this.status.startWidth+this.status.currentX-this.status.startX,e=this.status.startHeight+this.status.currentY-this.status.startY,o=this.setting.minWidth,i=this.setting.minHeight,a=this.setting.maxWidth,s=this.setting.maxHeight;"se"==this.status.dir?(t>o&&t<a&&this.setting.$el.outerWidth(t),e>i&&e<s&&this.setting.$el.outerHeight(e)):"s"==this.status.dir?e>i&&e<s&&this.setting.$el.outerHeight(e):"e"==this.status.dir&&t>o&&t<a&&this.setting.$el.outerWidth(t)},i={$el:$("<div></div>"),direction:null,edge:5,minWidth:10,minHeight:10,maxWidth:1e4,maxHeight:1e4,onStartResize:function(t){},onResize:function(t){},onStopResize:function(t){}},a=function(t){this.setting=$.extend({},i,t),this.status={startWidth:null,startHeight:null,startX:null,startY:null,currentX:null,currentY:null,isResizing:!1,dir:null};var e=this.setting.$el.addClass("mho-resizable");$.extend(this,{$el:e}),this.init()};a.prototype={init:function(){var t=this;this.setting.$el.bind("mousemove.resizable",function(o){var i=e.call(t,o);$(o.currentTarget).css("cursor",i?i+"-resize":"")}).bind("mousedown.resizable",function(i){var a=e.call(t,i);a&&($.extend(t.status,{startWidth:t.setting.$el.outerWidth(),startHeight:t.setting.$el.outerHeight(),startX:i.pageX,startY:i.pageY,isResizing:!0,dir:a}),$(document).bind("mousedown.resizable",function(e){(function(t){this.setting.onStartResize.call(this,t)}).call(t,e)}),$(document).bind("mousemove.resizable",function(e){(function(t){if(0==this.status.isResizing)return!1;$.extend(this.status,{currentX:t.pageX,currentY:t.pageY}),0!=this.setting.onResize.call(this,t)&&o.call(this)}).call(t,e)}),$(document).bind("mouseup.resizable",function(e){(function(t){$.extend(this.status,{isResizing:!1}),o.call(this),this.setting.onStopResize.call(this,t),$(document).unbind(".resizable"),$("body").css("cursor","")}).call(t,e)}))})}},t.resizable=a}(MHO)),$(function(t){var e=0,o=function(t,e){var o,i=t[0].styleSheet?t[0].styleSheet:t[0].sheet,a=i.cssRules||i.rules;return $.each(a,function(t,i){i.selectorText!=e||(o=i)}),o},i=function(t,e){for(var i in e){var a=o(t,i);for(var s in e[i])a.style[s]=e[i][s]}},a=function(e,o,a){var s=this;$.each(o,function(t,o){var i=$("<tr></tr>").appendTo(e);$.each(o,function(t,e){e.width||(e.width=80);var o="colspan="+e.colspan+" rowspan="+e.rowspan+' data-field="'+e.field+'" title="'+e.text+'"',a=$("<td "+o+"></td>").appendTo(i),n="mho-table-cell-filed-"+e.field,l=($('<div class="'+(e.colspan>1?"mho-table-cell-group":"mho-table-cell "+n)+'">'+e.text+"</div>").appendTo(a),e.colspan>1||$('<div class="mho-table-header-tools"><div class="mho-table-sort-icon"></div></div>').appendTo(a),{}),r=".cid-"+s._cid+" ."+n,d="width:"+e.width+"px;";l[r]=d,function(t,e){for(var o in e)t.append("\n"+o+"{"+e[o]+"}")}(s.$style,l)})}),e.find(".mho-table-header-tools").click(function(){var t=$(this).closest("td").attr("data-field");$(this).find(".mho-table-sort-icon").hasClass("asc")?($(this).find(".mho-table-sort-icon").addClass("desc").removeClass("asc"),s.sort(t,-1)):($(this).find(".mho-table-sort-icon").addClass("asc").removeClass("desc"),s.sort(t,1))}),e.find(".mho-table-cell").each(function(e,o){new t.resizable({$el:$(o),direction:"h",edge:5,minWidth:10,minHeight:10,maxWidth:1e4,maxHeight:1e4,onStartResize:function(t){},onResize:function(t){return s.$proxy.css({left:t.pageX-s.$el.offset().left}).show(),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),!1},onStopResize:function(t){n.call(s,!0,!1,!1);var e={};e[".cid-"+s._cid+" ."+this.$el[0].className.split(" ")[1]]={width:this.$el.outerWidth()+"px"},i(s.$style,e),s.$proxy.hide(),this.$el[0].style.width=""}})}),e.find(".mho-table-cell").add(e.find(".mho-table-cell-group")).each(function(e,o){var i,a;new t.draggable({$el:$(o),$proxy:function(){return $(o).clone(!0).css({background:"#6e6e6e",width:$(o).outerWidth(),height:$(o).outerHeight(),"text-align":$(o).css("text-align")}).appendTo("body")},revert:!0,onBeforeDrag:function(t){if(t.pageX>$(o).offset().left+$(o).outerWidth()-5)return!1;window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()},onStartDrag:function(t){var e=$(o).closest("td")[0],s=[];$(o).closest("table").find("tr").each(function(e,o){$(o).find("td").each(function(e,o){var i=$(o).offset().left,a=$(o).offset().left+$(o).outerWidth();$(o).outerWidth();t.pageX>i&&t.pageX<a&&s.push(o)})}),$.each(s,function(t,o){e==o&&s[t-1]&&(i=$(s[t-1]).offset().left,a=$(s[t-1]).offset().left+$(s[t-1]).outerWidth())})},onDrag:function(t){var e,n=$(o).closest("td")[0],l=t.pageX,r=h.call(s,l<s.$table1.offset().left+s.$table1.outerWidth(),l,n);$.each(r.toHeaders,function(t,o){o&&(e=o)}),e?s.$proxy.css({left:$(e).offset().left+$(e).outerWidth()-s.$el.offset().left-2}).show():s.$proxy.hide(),i&&a&&(l<i||l>a)&&s.$proxy.hide();var d=s.$body2.offset().left+s.$body2.outerWidth();s.$body2.scrollLeft(t.pageX-d),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()},onStopDrag:function(t){var e,l,r,b,c=$(o).closest("td")[0],f=t.pageX;if(i&&a&&(f<i||f>a))return s.$proxy.hide(),!1;e=!!$(o).closest(".mho-table-header").parent("div").hasClass("mho-table1"),l=f<s.$table1.offset().left+s.$table1.outerWidth(),r=d.call(s,e,c),b=h.call(s,l,f,c);var u,g,p=!1;if($.each(b.toHeaders,function(t,e){e&&(p=!0)}),$.each(b.toBodys,function(t,e){e&&(p=!0)}),$.each(r.moveHeaders,function(t,e){u||$.each(e,function(t,e){u=e})}),$.each(b.toHeaders,function(t,e){e&&(g=e)}),!p||u==g)return s.$proxy.hide(),!1;$.each(r.moveHeaders,function(t,e){for(var o=e.length-1;o>-1;o--){var i=e[o];b.toHeaders[t]?$(b.toHeaders[t]).after($(i)):l?s.$headerTable1.find("tr").eq(t).prepend($(i)):s.$headerTable2.find("tr").eq(t).prepend($(i))}}),$.each(r.moveBodys,function(t,e){for(var o=e.length-1;o>-1;o--){var i=e[o];b.toBodys[t]&&i&&$(b.toBodys[t]).after($(i))}}),$.each(r.moveFrozenBodys,function(t,e){for(var o=e.length-1;o>-1;o--){var i=e[o];b.toFrozenBodys[t]&&i&&$(b.toFrozenBodys[t]).after($(i))}}),n.call(s,!0,!1,!1),s.$proxy.hide()}})});var d=function(t,e){var o=t?this.$bodyTable1:this.$bodyTable2,i=t?this.$bodyFrozenTable1:this.$bodyFrozenTable2,a=this.getHeaders(t),s=[],n=new Array(a.length),l=new Array(o.find("tr").length),r=new Array(i.find("tr").length);return $.each(a,function(t,o){$.each(o,function(t,o){e==o&&s.push(t)})}),$.each(a,function(t,e){n[t]=[],$.each(e,function(e,o){-1!=$.inArray(e,s)&&n[t].push(o)})}),$.each(n,function(t,e){$.each(e,function(t,o){o==e[t-1]&&(e[t]=null)})}),o.find("tr").each(function(t,e){l[t]=[],$.each(s,function(o,i){l[t].push($(e).find("td").eq(i)[0])})}),i.find("tr").each(function(t,e){r[t]=[],$.each(s,function(o,i){r[t].push($(e).find("td").eq(i)[0])})}),{moveHeaders:n,moveBodys:l,moveFrozenBodys:r}},h=function(t,e,o){var i,a,s=$(o).closest("tr").index(),n=t?this.$bodyTable1:this.$bodyTable2,d=t?this.$bodyFrozenTable1:this.$bodyFrozenTable2,h=this.getHeaders(t),b=new Array(h.length),c=new Array(n.find("tr").length),f=new Array(d.find("tr").length);$.each(h,function(t,o){t<=s?$.each(o,function(o,s){if(s){l=$(s).offset().left,r=$(s).offset().left+$(s).outerWidth();$(s).outerWidth();e>l&&e<r&&(b[t]=s,i=l,a=r)}}):$.each(o,function(e,o){if(o){var s=$(o).offset().left,n=$(o).offset().left+$(o).outerWidth();s>=i-2&&n<=a+2&&(b[t]=o)}})});var u;return $.each(b,function(t,e){e&&(u=e)}),u&&(n.find("tr").each(function(t,e){$(e).find("td").each(function(e,o){var i=$(o).offset().left,a=$(o).offset().left+$(o).outerWidth();$(o).outerWidth();i>=$(u).offset().left-2&&a<=$(u).offset().left+$(u).outerWidth()+2&&(c[t]=o)})}),d.find("tr").each(function(t,e){$(e).find("td").each(function(e,o){var i=$(o).offset().left,a=$(o).offset().left+$(o).outerWidth();$(o).outerWidth();i>=$(u).offset().left-2&&a<=$(u).offset().left+$(u).outerWidth()+2&&(f[t]=o)})})),{toHeaders:b,toBodys:c,toFrozenBodys:f}};if(a){var b;this.setting.checkboxs&&(this.setting.singleSelect?(b=$('<td rowspan="'+o.length+'"><div class="mho-table-header-checkbox">&nbsp;</div></td>'),0==$("tr",e).length?b.wrap('<tr class="mho-table-header-row"></tr>').parent().appendTo(e):b.prependTo($("tr:first",e))):((b=$('<td rowspan="'+o.length+'"><div class="mho-table-header-checkbox"><input type="checkbox"></div></td>')).find('input[type="checkbox"]').bind("click",function(){$(this).prop("checked")?s.selectAll():s.unSelectAll()}),0==$("tr",e).length?b.wrap('<tr class="mho-table-header-row"></tr>').parent().appendTo(e):b.prependTo($("tr:first",e)))),this.setting.rownumbers&&(b=$('<td rowspan="'+o.length+'"><div class="mho-table-header-rownumber"></div></td>'),0==$("tr",e).length?b.wrap('<tr class="mho-table-header-row"></tr>').parent().appendTo(e):b.prependTo($("tr:first",e)))}},s=function(t,e,o){var i=this,a=this.getHeaderFieldColumns(o);$.isArray(this.setting.data)&&(this.setting.data={total:this.setting.data.length,rows:this.setting.data}),this.$bodyFrozenTable1.empty(),this.$bodyFrozenTable2.empty(),t.empty(),$.each(this.setting.data.rows,function(e,s){var n=i.setting.rowStyler?i.setting.rowStyler(s):"",l=$('<tr class="'+n+'"></tr>').appendTo(t).data({row:s});if(l.bind("mouseover",function(){$(this).closest("table")[0]==i.$bodyTable1[0]||$(this).closest("table")[0]==i.$bodyTable2[0]?(i.$bodyTable1.find("tr").eq($(this).index()).css({background:"#ddd"}),i.$bodyTable2.find("tr").eq($(this).index()).css({background:"#ddd"})):(i.$bodyFrozenTable1.find("tr").eq($(this).index()).css({background:"#ddd"}),i.$bodyFrozenTable2.find("tr").eq($(this).index()).css({background:"#ddd"}))}),l.bind("mouseout",function(){$(this).closest("table")[0]==i.$bodyTable1[0]||$(this).closest("table")[0]==i.$bodyTable2[0]?(i.$bodyTable1.find("tr").eq($(this).index()).css({background:""}),i.$bodyTable2.find("tr").eq($(this).index()).css({background:""})):(i.$bodyFrozenTable1.find("tr").eq($(this).index()).css({background:""}),i.$bodyFrozenTable2.find("tr").eq($(this).index()).css({background:""}))}),l.bind("click",function(){l=$(this).closest("table")[0]==i.$bodyTable1[0]||$(this).closest("table")[0]==i.$bodyTable2[0]?i.$bodyTable1.find("tr").eq($(this).index()):i.$bodyFrozenTable1.find("tr").eq($(this).index()),i.setting.checkOnSelect&&l.find('.mho-table-body-checkbox [type="checkbox"]').click(),i.setting.onClickRow.call(i,s)}),$.each(a,function(t,o){var i=o.field,a=o.formatter,n=s[i]?s[i]:"",r=$("<td "+('data-field="'+i+'" title="'+n+'"')+"></td>").appendTo(l);a&&(n=a.call(this,e,n,s,r));$('<div class="mho-table-cell '+("mho-table-cell-filed-"+i)+'"></div>').append(n).appendTo(r)}),o){var r;i.setting.checkboxs&&((r=$('<td><div class="mho-table-body-checkbox"><input type="checkbox"></div></td>')).find('input[type="checkbox"]').bind("click",function(t){t.stopPropagation();var e=$(this).prop("checked"),o=i.$bodyFrozenTable1.find("tr").add(i.$bodyTable1.find("tr")).index($(this).closest("tr"));e?i.selectRow(o):i.unSelectRow(o)}),r.prependTo(l)),i.setting.rownumbers&&(r=$('<td><div class="mho-table-body-rownumber">'+(e+1)+"</div></td>")).prependTo(l)}})},n=function(t,e,o){var a=this;this.$el.css({width:this.setting.width,height:this.setting.height});var s=this.$el.clone(!0).css({position:"absolute",left:"-10000"}).appendTo($("body")),n={$el:s,$wrapper:s.find(".mho-table-wrapper"),$table1:s.find(".mho-table1"),$table2:s.find(".mho-table2"),$header1:s.find(".mho-table1 .mho-table-header"),$header2:s.find(".mho-table2 .mho-table-header"),$body1:s.find(".mho-table1 .mho-table-body"),$body2:s.find(".mho-table2 .mho-table-body"),$footer1:s.find(".mho-table1 .mho-table-footer"),$footer2:s.find(".mho-table2 .mho-table-footer"),$headerTable1:s.find(".mho-table1 .mho-table-header .mho-table-htable"),$headerTable2:s.find(".mho-table2 .mho-table-header .mho-table-htable"),$bodyTable1:s.find(".mho-table1 .mho-table-body .mho-table-btable"),$bodyTable2:s.find(".mho-table2 .mho-table-body .mho-table-btable"),$bodyFrozenTable1:s.find(".mho-table1 .mho-table-body .mho-table-btable-frozen"),$bodyFrozenTable2:s.find(".mho-table2 .mho-table-body .mho-table-btable-frozen"),$proxy:s.find(".mho-table-proxy"),$pager:s.find(".mho-table-pager"),$style:s.find("style")};if(o&&1==this.setting.fit){var l=n.$el.outerWidth()-n.$el.find(".mho-table-header-rownumber").outerWidth()-n.$el.find(".mho-table-header-checkbox").outerWidth(),r=0;fieldColumns=this.getHeaderFieldColumns(!0).concat(this.getHeaderFieldColumns(!1)),$.each(fieldColumns,function(t,e){r+=e.width}),$.each(fieldColumns,function(t,e){var o=r<l?e.width/r*l:e.width,s={};s[".cid-"+a._cid+" .mho-table-cell-filed-"+e.field]={width:o+"px"},i(a.$style,s)})}n.$header1.outerHeight(),n.$header2.outerHeight();var d=n.$headerTable1.outerWidth()+1,h=n.$headerTable2.outerWidth(),b=n.$table1.outerHeight(),c=n.$table2.outerHeight(),f=n.$pager.outerHeight();if(this.setting.width||(n.$el.outerWidth(d+h),this.$el.outerWidth(d+h)),this.setting.height||(n.$el.outerHeight(Math.max(b+f,c+f)),this.$el.outerHeight(Math.max(b+f,c+f))),n.$wrapper.css({bottom:f}),this.$wrapper.css({bottom:f}),t){var u=n.$el.outerWidth();n.$table1.outerWidth(d),this.$table1.outerWidth(d),n.$table2.outerWidth(u-d),this.$table2.outerWidth(u-d),n.$table2.outerWidth(u-d),this.$table2.outerWidth(u-d)}if(e){n.$headerTable1.height(n.$headerTable2.outerHeight()),this.$headerTable1.height(n.$headerTable2.outerHeight()),n.$headerTable2.height(n.$headerTable1.outerHeight()),this.$headerTable2.height(n.$headerTable1.outerHeight());var g=n.$el.outerHeight();n.$table1.outerHeight(g-f),this.$table1.outerHeight(g-f),n.$table2.outerHeight(g-f),this.$table2.outerHeight(g-f),n.$bodyFrozenTable1.css({top:n.$header1.outerHeight(),height:n.$bodyFrozenTable1.outerHeight()}),this.$bodyFrozenTable1.css({top:n.$header1.outerHeight(),height:n.$bodyFrozenTable1.outerHeight()}),n.$bodyFrozenTable2.css({top:n.$header2.outerHeight(),height:n.$bodyFrozenTable1.outerHeight()}),this.$bodyFrozenTable2.css({top:n.$header2.outerHeight(),height:n.$bodyFrozenTable1.outerHeight()}),n.$body2.css({"margin-top":n.$bodyFrozenTable2.outerHeight()}).outerHeight(n.$table2.outerHeight()-n.$header2.outerHeight()-n.$footer2.outerHeight()-n.$bodyFrozenTable2.outerHeight()),this.$body2.css({"margin-top":n.$bodyFrozenTable2.outerHeight()}).outerHeight(n.$table2.outerHeight()-n.$header2.outerHeight()-n.$footer2.outerHeight()-n.$bodyFrozenTable2.outerHeight()),n.$body1.css({"margin-top":n.$bodyFrozenTable1.outerHeight()}).outerHeight(n.$table1.outerHeight()-n.$header1.outerHeight()-n.$footer1.outerHeight()-n.$bodyFrozenTable1.outerHeight()),this.$body1.css({"margin-top":n.$bodyFrozenTable1.outerHeight()}).outerHeight(n.$table1.outerHeight()-n.$header1.outerHeight()-n.$footer1.outerHeight()-n.$bodyFrozenTable1.outerHeight()),this.$bodyTable2.css({height:n.$bodyTable1.outerHeight()})}n.$el.remove()},d={$el:null,className:"",width:null,height:null,fit:!1,resize:!1,rownumbers:!1,checkboxs:!1,singleSelect:!1,checkOnSelect:!1,rowStyler:null,frozenColumns:[[]],columns:[[]],data:null,url:null,pagable:!1,pageSize:30,page:1,onLoadSuccess:null,onClickRow:function(t){},onSelect:function(t){}},h=function(t){this._cid=e++,this.setting=$.extend({},d,t);var o=this.setting.$el?this.setting.$el:$("<div></div>");o.addClass("mho-table").addClass("cid-"+this._cid).html('<div class="mho-table-wrapper"><div class="mho-table1"><div class="mho-table-header"><table class="mho-table-htable" cellspacing=0 cellpadding=0 border=0></table></div><div class="mho-table-body"><table class="mho-table-btable-frozen" cellspacing=0 cellpadding=0 border=0></table><table class="mho-table-btable" cellspacing=0 cellpadding=0 border=0></table><div style="height:20px;width:100%;"></div></div><div class="mho-table-footer"></div></div><div class="mho-table2"><div class="mho-table-header"><div style="float: left;width: 10000px;"><table class="mho-table-htable" cellspacing=0 cellpadding=0 border=0></table></div></div><div class="mho-table-body"><table class="mho-table-btable-frozen" cellspacing=0 cellpadding=0 border=0></table><table class="mho-table-btable" cellspacing=0 cellpadding=0 border=0></table></div><div class="mho-table-footer"></div></div><div style="clear:both;"></div><div class="mho-table-proxy"></div></div><div class="mho-table-pager"><ul><li><a href="javascript:void(0)" class="mho-table-page-first">首页</a></li><li><ul class="mho-table-page-number"></ul></li><li><a href="javascript:void(0)" class="mho-table-page-last">尾页</a></li><li><span>共<a class="mho-table-pager-total"></a>条数据</span></li></ul></div>'),$style=$('<style id="stylesheet'+this._cid+'" type="text/css"></style>'),$("body").append($style),$.extend(this,{$el:o,$wrapper:o.find(".mho-table-wrapper"),$table1:o.find(".mho-table1"),$table2:o.find(".mho-table2"),$header1:o.find(".mho-table1 .mho-table-header"),$header2:o.find(".mho-table2 .mho-table-header"),$body1:o.find(".mho-table1 .mho-table-body"),$body2:o.find(".mho-table2 .mho-table-body"),$footer1:o.find(".mho-table1 .mho-table-footer"),$footer2:o.find(".mho-table2 .mho-table-footer"),$headerTable1:o.find(".mho-table1 .mho-table-header .mho-table-htable"),$headerTable2:o.find(".mho-table2 .mho-table-header .mho-table-htable"),$bodyTable1:o.find(".mho-table1 .mho-table-body .mho-table-btable"),$bodyTable2:o.find(".mho-table2 .mho-table-body .mho-table-btable"),$bodyFrozenTable1:o.find(".mho-table1 .mho-table-body .mho-table-btable-frozen"),$bodyFrozenTable2:o.find(".mho-table2 .mho-table-body .mho-table-btable-frozen"),$proxy:o.find(".mho-table-proxy"),$pager:o.find(".mho-table-pager"),$pageNum:o.find(".mho-table-page-number"),$first:o.find(".mho-table-page-first"),$last:o.find(".mho-table-page-last"),$total:o.find(".mho-table-pager-total"),$style:$style}),this.init()};h.prototype={init:function(){this.$el.addClass(this.setting.className),this.setting.pagable||this.$pager.remove(),this._initEvents(),this._renderHeader(),this.setting.url?this.reload():(this._renderBody(),this._renderPager())},_initEvents:function(){var t=this;this.$body1.bind("mousewheel DOMMouseScroll",function(e){e.preventDefault();var o=e.originalEvent||window.event,i=o.wheelDelta||-1*o.detail;"deltaY"in o&&(i=-1*o.deltaY),t.$body2.scrollTop(t.$body2.scrollTop()-i)}),this.$body2.bind("scroll",function(e){t.$body1.scrollTop($(this).scrollTop()+.5),t.$header2.scrollLeft($(this).scrollLeft()),t.$footer2.scrollLeft($(this).scrollLeft()),t.$bodyFrozenTable2.css({left:-$(this).scrollLeft()})}),this.$first.bind("click.mho-table-page-first",function(e){t.setting.page=1,t.reload()}),this.$last.bind("click.mho-table-page-last",function(e){var o=t.setting.data.total,i=t.setting.pageSize,a=Math.ceil(o/i);t.setting.page=a,t.reload()})},_renderHeader:function(){a.call(this,this.$headerTable1,this.setting.frozenColumns,!0),a.call(this,this.$headerTable2,this.setting.columns,!1),n.call(this,!0,!1,!0)},_renderBody:function(){s.call(this,this.$bodyTable1,this.setting.frozenColumns,!0),s.call(this,this.$bodyTable2,this.setting.columns,!1),this.setting.onLoadSuccess&&this.setting.onLoadSuccess.call(this,this.setting.data),n.call(this,!1,!0,!1)},_renderPager:function(){var t=this,e=this.setting.data.total,o=(this.setting.page,this.setting.pageSize),i=Math.ceil(e/o);this.$total.html(this.setting.data.total),this.$pageNum.empty();for(var a=0;a<i;a++)this.$pageNum.append('<li><a href="javascript:void(0)">'+(a+1)+"</a></li>");this.$pageNum.find("a").click(function(){t.gotoPage($(this).html())})},reload:function(){var t=this;$.get(this.setting.url,{page:this.setting.page,pageSize:this.setting.pageSize},function(e){t.setting.data=e,t._renderPager(),t._renderBody()},"json")},appendTo:function(t){return this.$el.appendTo(t),this},getHeaders:function(t){var e=t?this.$headerTable1.find("tr"):this.$headerTable2.find("tr"),o=new Array(e.length),i=0;return e.eq(0).find("td").each(function(t,e){i+=parseInt($(e).attr("colspan"))||1}),$.each(o,function(t,e){o[t]=[];for(var a=0;a<i;a++)o[t].push(0)}),e.each(function(t,e){$(e).find("td").each(function(e,i){var a,s,n=parseInt($(i).attr("rowspan"))||1,l=parseInt($(i).attr("colspan"))||1;if(n>1)if(l>1)for(s=t;s<t+n;s++)for(var r=0;r<l;r++)a=o[s].indexOf(0),o[s][a]=s==t?i:null;else for(a=o[t].indexOf(0),s=t;s<t+n;s++)o[s][a]=s==t?i:null;else if(l>1)for(s=0;s<l;s++)a=o[t].indexOf(0),o[t][a]=i;else a=o[t].indexOf(0),o[t][a]=i})}),o},getHeaderFieldColumns:function(t){var e=this,o=this.getHeaders(t);this.setting.rownumbers&&t&&$.each(o,function(t,e){e.splice(0,1)}),this.setting.checkboxs&&t&&$.each(o,function(t,e){e.splice(0,1)});var i=new Array(o[0].length);return $.each(o,function(o,a){$.each(a,function(o,a){a&&(i[o]=e.getColumnByField($(a).attr("data-field"),t))})}),i},getColumnByField:function(t,e){var o,i=e?this.setting.frozenColumns:this.setting.columns;return $.each(i,function(e,i){$.each(i,function(e,i){i.field==t&&(o=i)})}),o},freezeRow:function(t){this.$bodyFrozenTable1.append(this.$bodyTable1.find("tr").eq(t)),this.$bodyFrozenTable2.append(this.$bodyTable2.find("tr").eq(t)),function(){var t=this.$bodyFrozenTable1.find("tr").length;this.setting.rownumbers&&(this.$bodyFrozenTable1.find("tr").each(function(t,e){$(e).find("td:eq(0) .mho-table-body-rownumber").html(t+1)}),this.$bodyTable1.find("tr").each(function(e,o){$(o).find("td:eq(0) .mho-table-body-rownumber").html(++t)}))}.call(this)},getFreezeRows:function(){var t=new Array(this.$bodyFrozenTable1.find("tr").length||this.$bodyFrozenTable2.find("tr").length);return this.$bodyFrozenTable1.find("tr").each(function(e,o){t[e]=$(o).data("row")}),this.$bodyFrozenTable2.find("tr").each(function(e,o){t[e]=$(o).data("row")}),t},sort:function(t,e){var o=this,i={asc:function(e,o){return e[t]>o[t]},desc:function(e,o){return e[t]<o[t]}},a=this.getFreezeRows();this.setting.data.rows.sort(-1==e?i.desc:i.asc),s.call(this,this.$bodyTable1,this.setting.frozenColumns,!0),s.call(this,this.$bodyTable2,this.setting.columns,!1),this.$bodyFrozenTable1.empty(),this.$bodyFrozenTable2.empty(),this.$bodyTable1.find("tr").each(function(t,e){-1!=$.inArray($(e).data("row"),a)&&o.freezeRow(t)})},getSelections:function(){var t=[];return this.$bodyFrozenTable1.add(this.$bodyTable1).find("tr.mho-table-selected-row").each(function(e,o){t.push($(o).data("row"))}),this.$bodyFrozenTable2.add(this.$bodyTable2).find("tr.mho-table-selected-row").each(function(e,o){t[e]||t.push($(o).data("row"))}),t},selectRow:function(t){if(this.setting.singleSelect)this.$bodyTable1.add(this.$bodyTable2).add(this.$bodyFrozenTable1).add(this.$bodyFrozenTable2).find("tr").removeClass("mho-table-selected-row"),this.$bodyTable1.find('tr .mho-table-body-checkbox [type="checkbox"]').prop("checked",!1),this.$bodyFrozenTable1.find('tr .mho-table-body-checkbox [type="checkbox"]').prop("checked",!1),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).addClass("mho-table-selected-row"),this.$bodyFrozenTable2.find("tr").add(this.$bodyTable2.find("tr")).eq(t).addClass("mho-table-selected-row"),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).find('.mho-table-body-checkbox [type="checkbox"]').prop("checked",!0);else{this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).addClass("mho-table-selected-row"),this.$bodyFrozenTable2.find("tr").add(this.$bodyTable2.find("tr")).eq(t).addClass("mho-table-selected-row"),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).find('.mho-table-body-checkbox [type="checkbox"]').prop("checked",!0);var e=!0;this.$bodyFrozenTable1.find('.mho-table-body-checkbox input[type="checkbox"]').add(this.$bodyTable1.find('.mho-table-body-checkbox input[type="checkbox"]')).each(function(t,o){0==$(o).prop("checked")&&(e=!1)}),this.$header1.find('.mho-table-header-checkbox input[type="checkbox"]').prop("checked",e)}this.setting.onSelect&&this.setting.onSelect.call(this,this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).data("row"))},unSelectRow:function(t){if(this.setting.singleSelect)this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).removeClass("mho-table-selected-row"),this.$bodyFrozenTable2.find("tr").add(this.$bodyTable2.find("tr")).eq(t).removeClass("mho-table-selected-row"),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).find('.mho-table-body-checkbox [type="checkbox"]').prop("checked",!1);else{this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).removeClass("mho-table-selected-row"),this.$bodyFrozenTable2.find("tr").add(this.$bodyTable2.find("tr")).eq(t).removeClass("mho-table-selected-row"),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).eq(t).find('.mho-table-body-checkbox [type="checkbox"]').prop("checked",!1);var e=!0;this.$bodyFrozenTable1.find('.mho-table-body-checkbox input[type="checkbox"]').add(this.$bodyTable1.find('.mho-table-body-checkbox input[type="checkbox"]')).each(function(t,o){0==$(o).prop("checked")&&(e=!1)}),this.$header1.find('.mho-table-header-checkbox input[type="checkbox"]').prop("checked",e)}},selectAll:function(){this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).addClass("mho-table-selected-row"),this.$bodyFrozenTable2.find("tr").add(this.$bodyTable2.find("tr")).addClass("mho-table-selected-row"),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).find('.mho-table-body-checkbox [type="checkbox"]').prop("checked",!0),this.$header1.find('.mho-table-header-checkbox input[type="checkbox"]').prop("checked",!0)},unSelectAll:function(){this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).removeClass("mho-table-selected-row"),this.$bodyFrozenTable2.find("tr").add(this.$bodyTable2.find("tr")).removeClass("mho-table-selected-row"),this.$bodyFrozenTable1.find("tr").add(this.$bodyTable1.find("tr")).find('.mho-table-body-checkbox [type="checkbox"]').prop("checked",!1),this.$header1.find('.mho-table-header-checkbox input[type="checkbox"]').prop("checked",!1)},gotoPage:function(t){this.setting.page=t,this.reload()},resize:function(t,e){this.setting.width=t,this.setting.height=e,n.call(this,!0,!0,!0)}},t.table=h}(MHO));